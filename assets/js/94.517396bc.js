(window.webpackJsonp=window.webpackJsonp||[]).push([[94],{384:function(t,s,a){"use strict";a.r(s);var n=a(10),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"vue系列之4-原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue系列之4-原理"}},[t._v("#")]),t._v(" Vue系列之4-原理")]),t._v(" "),s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),s("ul",[s("li",[t._v("前端三大框架对比")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("框架")]),t._v(" "),s("th",[t._v("发布年份")]),t._v(" "),s("th",[t._v("出自")]),t._v(" "),s("th",[t._v("star数")]),t._v(" "),s("th",[t._v("特性")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("Angular")]),t._v(" "),s("td",[t._v("2010年")]),t._v(" "),s("td",[t._v("Google")]),t._v(" "),s("td",[t._v("73.7k")]),t._v(" "),s("td",[t._v("双向数据绑定")])]),t._v(" "),s("tr",[s("td",[t._v("React")]),t._v(" "),s("td",[t._v("2013年")]),t._v(" "),s("td",[t._v("Facebook")]),t._v(" "),s("td",[t._v("169k")]),t._v(" "),s("td",[t._v("VirtualDOM、Redux")])]),t._v(" "),s("tr",[s("td",[t._v("Vue")]),t._v(" "),s("td",[t._v("2014年")]),t._v(" "),s("td",[t._v("尤雨溪EvanYou")]),t._v(" "),s("td",[t._v("184k")]),t._v(" "),s("td",[t._v("更轻量、易于上手、中文文档友好")])])])]),t._v(" "),s("ul",[s("li",[s("p",[t._v("框架趋同/互相借鉴")]),t._v(" "),s("ul",[s("li",[t._v("Vue借鉴knockout模板引擎、借鉴Angular双向数据绑定、借鉴React虚拟dom/redux/JSX")]),t._v(" "),s("li",[t._v("跨端开发（Ionic/ReactNative/Weex）")]),t._v(" "),s("li",[t._v("桌面开发（electron支持vue/react）")]),t._v(" "),s("li",[t._v("总之，你有我有全都有，大家好才是真的好")])])]),t._v(" "),s("li",[s("p",[t._v("类vue的开发模式（新赛道）：小程序、uniapp")])])]),t._v(" "),s("p",[t._v("阅读本文后你将了解到：")]),t._v(" "),s("ul",[s("li",[t._v("Vue是什么？解决了什么问题？")]),t._v(" "),s("li",[t._v("MVVM架构")]),t._v(" "),s("li",[t._v("三要素（响应式、模板编译、vdom/diff算法）")]),t._v(" "),s("li",[t._v("组件渲染/更新过程")])]),t._v(" "),s("p",[t._v("PS：本文内容主要针对Vue2，涉及少量vue3.0内容")]),t._v(" "),s("h2",{attrs:{id:"一、vue是什么"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#一、vue是什么"}},[t._v("#")]),t._v(" 一、Vue是什么？")]),t._v(" "),s("p",[s("strong",[t._v("vue是什么？")])]),t._v(" "),s("blockquote",[s("p",[t._v("Vue (读音 /vjuː/，类似于 "),s("strong",[t._v("view")]),t._v(") 是一套用于"),s("strong",[t._v("构建用户界面的渐进式框架")]),t._v("。与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与"),s("strong",[t._v("现代化的工具链以及各种支持类库")]),t._v("结合使用时，Vue 也完全能够为复杂的单页应用提供驱动。")])]),t._v(" "),s("ul",[s("li",[t._v("轻量级渐进式框架（便于与第三方库或既有项目整合）")]),t._v(" "),s("li",[t._v("生态丰富（vue-cli、vue-router、vuex、社区UI组件库...）")]),t._v(" "),s("li",[t._v("易于上手（入门简单、中文文档友好）")])]),t._v(" "),s("p",[s("strong",[t._v("vue解决了什么问题？")])]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("HTML")]),t._v("：从0到1")]),t._v(" "),s("li",[s("strong",[t._v("CSS")]),t._v("：提供装饰")]),t._v(" "),s("li",[s("strong",[t._v("JavaScript(DOM)")]),t._v("：支持页面动态化（例如倒计时）")]),t._v(" "),s("li",[s("strong",[t._v("jQuery")]),t._v("：解决浏览器兼容问题、优雅API（解放前端，造轮子）")]),t._v(" "),s("li",[s("strong",[t._v("Vue")]),t._v("："),s("strong",[t._v("数据驱动视图")]),t._v("，让开发者从DOM操作中解放（如倒计时，自加器）")])]),t._v(" "),s("p",[s("strong",[t._v("疑问：数据驱动视图是怎么做到的？（数据变化 -> 视图更新）")])]),t._v(" "),s("h3",{attrs:{id:"_1、如何理解mvvm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1、如何理解mvvm"}},[t._v("#")]),t._v(" 1、如何理解MVVM")]),t._v(" "),s("blockquote",[s("p",[t._v("MVVM是一种软件架构模式，MVVM是MVP的变体，MVP模式和MVVM模式都是MVC模式的变体。"),s("a",{attrs:{href:"http://www.ruanyifeng.com/blog/2015/02/mvcmvp_mvvm.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("MVC，MVP 和 MVVM 的图示"),s("OutboundLink")],1)])]),t._v(" "),s("blockquote",[s("p",[t._v("软件构架对代码进行解耦分层，各层互不影响，有效降低了开发复杂度。我们可以通过调整MVC三者之前的通信模式，来达到一定的架构目的。")])]),t._v(" "),s("p",[t._v("MVVM对视图更新模式的影响")]),t._v(" "),s("ul",[s("li",[t._v("静态渲染：更新需要进行DOM操作，如ASP/JSP/PHP，适合业务简单的场景")]),t._v(" "),s("li",[t._v("数据驱动视图：通过数据即可更新视图，如Vue/React/Angular，适合业务复杂的场景")])]),t._v(" "),s("p",[t._v("MVVM包含3部分：")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("View")]),t._v("：用户看到屏幕的结构、布局和外观，也称UI")]),t._v(" "),s("li",[s("strong",[t._v("ViewModel")]),t._v("：是一个绑定器，能和 "),s("code",[t._v("View")]),t._v(" 和 "),s("code",[t._v("Model")]),t._v(" 层进行通信")]),t._v(" "),s("li",[s("strong",[t._v("Model")]),t._v("：是数据和逻辑")])]),t._v(" "),s("h3",{attrs:{id:"_2、mvvm在vue中的体现"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2、mvvm在vue中的体现"}},[t._v("#")]),t._v(" 2、MVVM在Vue中的体现")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a3e0fecfffa34c1f9e8d34572f52e7e2~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[t._v("示例：")]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("h1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("{{ message }}"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("h1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("button")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@click")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("reverse"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("reverse"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("button")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("var")]),t._v(" app "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("el")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#app"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("message")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello Vue123!!"')]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("methods")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reverse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("split")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("reverse")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("join")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('""')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br")])]),s("ul",[s("li",[t._v("View: template模板")]),t._v(" "),s("li",[t._v("Model: data数据")]),t._v(" "),s("li",[t._v("ViewModel: Vue实例")])]),t._v(" "),s("p",[t._v("PS：Vue没有严格遵循 MVVM 模式：严格的MVVM要求View不能和Model直接通信，而Vue在组件中提供了$refs这个属性，让Model可以直接操作View，违反了这一规定。")]),t._v(" "),s("p",[s("strong",[t._v("疑问：vue是如何实现MVVM的？")])]),t._v(" "),s("h3",{attrs:{id:"_3、vue三要素"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3、vue三要素"}},[t._v("#")]),t._v(" 3、Vue三要素")]),t._v(" "),s("ul",[s("li",[t._v("响应式：vue如何监听到 data 的每个属性变化？")]),t._v(" "),s("li",[t._v("模板引擎：vue的模板如何被解析？")]),t._v(" "),s("li",[t._v("渲染：vue如何进行高效渲染？")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa6b219179c14b13abd1d436703e2099~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("h2",{attrs:{id:"二、vue三要素-响应式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#二、vue三要素-响应式"}},[t._v("#")]),t._v(" 二、Vue三要素-响应式")]),t._v(" "),s("blockquote",[s("p",[t._v("响应式：组件 data 的数据一旦变化，立刻触发视图的更新。\n响应式如何实现？")])]),t._v(" "),s("h3",{attrs:{id:"object-defineproperty-ie9"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#object-defineproperty-ie9"}},[t._v("#")]),t._v(" Object.defineProperty（IE9+）")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" obj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("null")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nObject"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("defineProperty")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'trigger get'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 收集依赖 todo...")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("val")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'trigger set'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("val "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            value "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" val"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据变更，需要重新渲染 todo...")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        \n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nobj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br")])]),s("p",[t._v("缺点")]),t._v(" "),s("ul",[s("li",[t._v("深度监听需要递归到底，一次性计算量大")]),t._v(" "),s("li",[t._v("无法监听新增属性/删除属性（Vue.$set）")]),t._v(" "),s("li",[t._v("无法原生监听数组，需要特殊处理")])]),t._v(" "),s("h3",{attrs:{id:"proxy-vue3-0-ie11"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-vue3-0-ie11"}},[t._v("#")]),t._v(" proxy（Vue3.0，IE11+）")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" obj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" reactiveObj "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prop")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'trigger get'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 收集依赖 todo...")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("prop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("set")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" prop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        console"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'trigger set'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("prop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("obj"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("prop"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!==")]),t._v(" value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 数据变更，需要重新渲染 todo...")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br")])]),s("p",[t._v("缺点：")]),t._v(" "),s("ul",[s("li",[t._v("有兼容性的问题，caniuse 95%")]),t._v(" "),s("li",[t._v("它会修改JavaScript的一些底层代码的执行方式，所以它是无法被完全polyfill的")])]),t._v(" "),s("p",[t._v("响应式带来的问题：")]),t._v(" "),s("ul",[s("li",[t._v("jQuery可以自行控制DOM操作的时机，手动调整，而响应式的DOM操作则在内部进行；")]),t._v(" "),s("li",[t._v("DOM 操作非常耗费性能")])]),t._v(" "),s("p",[s("strong",[t._v("疑问：如何有效控制DOM操作？")])]),t._v(" "),s("h2",{attrs:{id:"三、vue三要素-渲染-虚拟dom-virtual-dom"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三、vue三要素-渲染-虚拟dom-virtual-dom"}},[t._v("#")]),t._v(" 三、Vue三要素-渲染：虚拟DOM（Virtual DOM）")]),t._v(" "),s("blockquote",[s("p",[t._v("Vue是数据驱动视图，如何有效控制DOM操作？")])]),t._v(" "),s("ul",[s("li",[t._v("解决方案："),s("code",[t._v("vdom")]),t._v(" "),s("ul",[s("li",[t._v("JS执行速度快")]),t._v(" "),s("li",[t._v("用JS模拟DOM结构，计算出最小的变更，操作DOM")])])]),t._v(" "),s("li",[s("code",[t._v("vdom")]),t._v(" 是优化方案，不是响应式必须\n"),s("ul",[s("li",[s("code",[t._v("vdom")]),t._v(" 是实现 "),s("code",[t._v("vue")]),t._v(" 和 "),s("code",[t._v("react")]),t._v(" 的重要基石")]),t._v(" "),s("li",[s("code",[t._v("diff算法")]),t._v(" 是 "),s("code",[t._v("vdom")]),t._v(" 中最核心、最关键的部分")])])]),t._v(" "),s("li",[t._v("用JS模拟DOM结构："),s("code",[t._v("vnode")])])]),t._v(" "),s("div",{staticClass:"language-html line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("div")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("div1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("container"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("p")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("vdom"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("p")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("ul")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token special-attr"}},[s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("style")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),s("span",{pre:!0,attrs:{class:"token value css language-css"}},[s("span",{pre:!0,attrs:{class:"token property"}},[t._v("font-size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" 20px"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("li")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("a"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("li")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("ul")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("div")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tag")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("props")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("classname")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'container'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'div1'")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tag")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vdom'")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tag")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ul'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("props")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("style")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'font-size: 20px;'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("tag")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'li'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n                    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("children")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'a'")]),t._v("\n                "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br")])]),s("ul",[s("li",[s("code",[t._v("vdom")]),t._v(" 小结：数据驱动视图的模式下，有效控制DOM操作\n"),s("ul",[s("li",[s("code",[t._v("vnode")]),t._v("：用JS模拟DOM结构")]),t._v(" "),s("li",[s("code",[t._v("diff算法")]),t._v("：新旧vnode对比，得出最小更新范围，最后更新DOM")])])])]),t._v(" "),s("h2",{attrs:{id:"四、diff算法-vdom核心部分"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#四、diff算法-vdom核心部分"}},[t._v("#")]),t._v(" 四、diff算法-vdom核心部分")]),t._v(" "),s("blockquote",[s("p",[t._v("diff 算法是一种通过同层的树节点进行比较的高效算法，避免了对树进行逐层搜索遍历，所以时间复杂度只有 O(n)")])]),t._v(" "),s("h3",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[t._v("#")]),t._v(" 概述：")]),t._v(" "),s("ul",[s("li",[t._v("diff即对比，是一个广泛的概念（非独创），如linux diff命令，git diff等")]),t._v(" "),s("li",[t._v("两个js对象也可以做diff")]),t._v(" "),s("li",[t._v("两棵树做diff，如这里的vdom diff")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/286a4362483c4cafb3fb8615cefe94bc~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("h3",{attrs:{id:"树diff的时间复杂度o-n-3"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#树diff的时间复杂度o-n-3"}},[t._v("#")]),t._v(" 树diff的时间复杂度O(n^3)")]),t._v(" "),s("ul",[s("li",[t._v("1、遍历tree1")]),t._v(" "),s("li",[t._v("2、遍历tree2")]),t._v(" "),s("li",[t._v("3、排序")]),t._v(" "),s("li",[t._v("1000个节点，要计算1亿次，算法不可用")])]),t._v(" "),s("h3",{attrs:{id:"优化时间复杂度到o-n"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#优化时间复杂度到o-n"}},[t._v("#")]),t._v(" 优化时间复杂度到O(n)")]),t._v(" "),s("ul",[s("li",[t._v("只比较同一层级，不跨级比较")]),t._v(" "),s("li",[t._v("tag不相同，则直接删掉重建，不再深度比较")]),t._v(" "),s("li",[t._v("tag和key，两者都相同，则认为是相同节点，更新dom，并继续比较节点的子元素")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/39a203ea582649f5aba9bf27f86aada7~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68ef124893964d349a15fa4f32759b2d~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("h3",{attrs:{id:"diff算法流程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#diff算法流程"}},[t._v("#")]),t._v(" diff算法流程")]),t._v(" "),s("p",[t._v("1、首次渲染，取vnode进行渲染即可")]),t._v(" "),s("p",[t._v("2、数据更新后，将vnode和oldVnode进行对比")]),t._v(" "),s("ul",[s("li",[t._v("从根节点开始遍历，判断当前的旧节点和新节点是否同一节点（sel和key相同）")]),t._v(" "),s("li",[t._v("若不是同一节点，则删掉重建；")]),t._v(" "),s("li",[t._v("若是同一节点，则更新当前节点dom，继续处理子元素children")])]),t._v(" "),s("p",[t._v("3、"),s("strong",[t._v("子元素children的对比算法")]),t._v("（尽可能多地复用真实DOM,尽可能少的添加删除真实DOM）\n思路：添加4个指针，分别指向新旧children的开始和结束比较的过程中，循环从两边向中间收拢；")]),t._v(" "),s("ul",[s("li",[t._v("第一步：分别进行开始开始、结束结束、开始结束、结束开始对比，若匹配成功，则指针向中间收拢；")]),t._v(" "),s("li",[t._v("第二步：若第一步未匹配，则在旧children中遍历查找是否匹配新children的开始节点，若匹配成功，则移动旧节点到对应位置；")]),t._v(" "),s("li",[t._v("第三步：循环结束后，根据新老节点的数目不同做相应的添加或者删除节点操作")])]),t._v(" "),s("p",[t._v("各场景图示（这里看动画 👉  "),s("a",{attrs:{href:"https://www.bilibili.com/video/BV1b5411V7i3?from=search&seid=4125072074822008044",target:"_blank",rel:"noopener noreferrer"}},[t._v("diff算法图解动画"),s("OutboundLink")],1),t._v("）")]),t._v(" "),s("ul",[s("li",[t._v("k -> key")]),t._v(" "),s("li",[t._v("a/b/c/d -> 元素内容")]),t._v(" "),s("li",[t._v("所有元素的tag都相同，可以理解均为 "),s("code",[t._v("<li>")])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d0d8dca6afe24cd795af2edc2be7e049~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5295957102da4ba2b13eb6c8c65b4f73~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9ee3dec92df84644982cfb237166e12c~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e62d8912026f4bbf9f1975de26b8de73~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ad12f271b8484572b14e32048fbba20f~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[t._v("删除节点\n"),s("img",{attrs:{src:"https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f94f32ebd3040c9bec27350e554f8cf~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[t._v("新增节点\n"),s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5bdb95ad733f414f9542a5ebb4ec9175~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[t._v("未设置key\n"),s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/027885ad98f7446d8eefa107c481c6a7~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[t._v("设置key\n"),s("img",{attrs:{src:"https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/50d9e7701ad14f779de617fb3368fc3c~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("p",[t._v("需要说明的是，节点的更新有三种开销：")]),t._v(" "),s("ul",[s("li",[t._v("第一种是不能复用节点时，重建节点，更新dom")]),t._v(" "),s("li",[t._v("第二种是能复用节点时，直接更新dom")]),t._v(" "),s("li",[t._v("第三种是能复用节点，但需移动dom，然后更新")])]),t._v(" "),s("p",[t._v("数组加key即符合第三种情况。")]),t._v(" "),s("h2",{attrs:{id:"五、vue三要素-模板编译"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#五、vue三要素-模板编译"}},[t._v("#")]),t._v(" 五、Vue三要素-模板编译")]),t._v(" "),s("ul",[s("li",[s("p",[t._v("概览")]),t._v(" "),s("ul",[s("li",[t._v("前置知识：JS的with语法\n"),s("ul",[s("li",[t._v("改变{}内自由变量的查找规则，当做obj属性来查找")]),t._v(" "),s("li",[t._v("如果找不到匹配的obj属性，就会报错")]),t._v(" "),s("li",[t._v("with要慎用，它打破了作用域规则，易读性变差")])])]),t._v(" "),s("li",[t._v("vue模板(不是html，有指令、插值、JS表达式)到底是什么？")]),t._v(" "),s("li",[t._v("vue如何处理模板？组件渲染和更新过程？")])])]),t._v(" "),s("li",[s("p",[t._v("步骤：")]),t._v(" "),s("ol",[s("li",[s("strong",[t._v("vue-template-complier将模板"),s("code",[t._v("<template>")]),t._v("编译为 render 函数")])]),t._v(" "),s("li",[s("strong",[t._v("执行 render 函数生成 vnode")])]),t._v(" "),s("li",[t._v("基于 vnode 再执行 patch 和 diff，进行渲染和更新")]),t._v(" "),s("li",[t._v("修改数据后，会生成新的vnode")])])]),t._v(" "),s("li",[s("p",[t._v("vue模板被编译成什么（ "),s("code",[t._v("vue-template-compiler")]),t._v(" ）")])])]),t._v(" "),s("p",[s("code",[t._v("<p>"+t._s(t.message)+"</p>")])]),t._v(" "),s("p",[s("code",[t._v("with(this){return _c('p', [_v(_s(message))])}")])]),t._v(" "),s("p",[t._v("类似于：")]),t._v(" "),s("div",{staticClass:"language-js line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function-variable function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("createElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("createElement")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'p'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 标签名称")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("message"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toString")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 子节点数组")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("ul",[s("li",[t._v("其他注意点：\n"),s("ul",[s("li",[t._v("使用webpack vue-loader，会在开发环境编译模板")]),t._v(" "),s("li",[t._v("vue组件可以用render代替template，react默认使用render写法")])])])]),t._v(" "),s("h2",{attrs:{id:"六、vue的组件渲染-更新过程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#六、vue的组件渲染-更新过程"}},[t._v("#")]),t._v(" 六、Vue的组件渲染/更新过程")]),t._v(" "),s("ul",[s("li",[t._v("初次渲染过程\n"),s("ol",[s("li",[t._v("解析模板为render函数（或在开发环境已完成，vue-loader）")]),t._v(" "),s("li",[t._v("（页面渲染时）执行render函数，生成vnode，patch(elem,vnode)")]),t._v(" "),s("li",[t._v("触发响应式，监听data属性getter setter")])])]),t._v(" "),s("li",[t._v("更新过程\n"),s("ol",[s("li",[t._v("修改data，触发setter（此前在getter中已被监听）")]),t._v(" "),s("li",[t._v("重新执行render函数，生成newVnode")]),t._v(" "),s("li",[t._v("对比新旧vnode，patch(vnode,newVnode)，更新到dom上")])])])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/981c630c3aa8411d888a6c2442a88baa~tplv-k3u1fbpfcp-watermark.image",alt:"image.png"}})]),t._v(" "),s("h2",{attrs:{id:"七、vue3-0的性能优化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#七、vue3-0的性能优化"}},[t._v("#")]),t._v(" 七、Vue3.0的性能优化")]),t._v(" "),s("blockquote",[s("p",[t._v("性能比vue2.x快1.2～2倍")])]),t._v(" "),s("ul",[s("li",[s("p",[s("strong",[t._v("静态标记")]),t._v("：diff方法优化vue2.x中的虚拟dom是进行全量的对比。而vue3.0新增了静态标记。在与上次虚拟节点进行对比的时候，只对比带有patch flag的节点，并且可以通过flag的信息得知当前节点要对比的具体内容。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("静态提升")]),t._v("：vue2.x中无论元素是否参与更新，每次都会重新创建，然后再渲染。vue3.0中对于不参与更新的元素，会做静态提升，只会被创建一次，在渲染时直接复用即可。")])]),t._v(" "),s("li",[s("p",[s("strong",[t._v("事件侦听器缓存")]),t._v("：默认情况下，如onClick事件会被视为动态绑定，所以每次都会追踪它的变化，但是因为是同一个函数，所以不用追踪变化，直接缓存起来复用即可。")])])]),t._v(" "),s("h2",{attrs:{id:"回顾"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#回顾"}},[t._v("#")]),t._v(" 回顾")]),t._v(" "),s("ul",[s("li",[t._v("Vue是什么？解决了什么问题？")]),t._v(" "),s("li",[t._v("MVVM架构")]),t._v(" "),s("li",[t._v("三要素：响应式、模板编译、vdom/diff算法（重要）")]),t._v(" "),s("li",[t._v("组件渲染/更新过程（重要）")]),t._v(" "),s("li",[t._v("异步渲染\n"),s("ul",[s("li",[t._v("$nextTick")]),t._v(" "),s("li",[t._v("汇总data的修改，一次性更新视图")]),t._v(" "),s("li",[t._v("减少DOM操作次数，提高性能")])])])]),t._v(" "),s("h2",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://www.infoq.cn/article/udlcpkh4iqb0cr5wgy7f",target:"_blank",rel:"noopener noreferrer"}},[t._v("vue的diff算法执行过程解析"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://www.bilibili.com/video/BV1b5411V7i3?from=search&seid=4125072074822008044",target:"_blank",rel:"noopener noreferrer"}},[t._v("diff算法图解动画"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://developer.51cto.com/art/202010/628347.htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue3.0是如何变快的"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);