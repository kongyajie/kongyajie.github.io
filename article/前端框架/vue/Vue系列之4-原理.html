<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Vue系列之4-原理 | 前端AK君</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <script>
      var _hmt = _hmt || [];
      (function() {
        var hm = document.createElement("script");
        hm.src = "https://hm.baidu.com/hm.js?e864a64a0fefae1239747c553f0d6579";
        var s = document.getElementsByTagName("script")[0]; 
        s.parentNode.insertBefore(hm, s);
      })();
    </script>
    <script src="https://cdn-go.cn/aegis/aegis-sdk/latest/aegis.min.js"></script>
    <script>
      var aegis = new Aegis({
        id: 'yaoVL8AlJ1zqMDq4dG', // 上报 id
        uin: 'xxx', // 用户唯一 ID（可选）
        reportApiSpeed: true, // 接口测速
        reportAssetSpeed: true, // 静态资源测速
        spa: true // spa 应用页面跳转的时候开启 pv 计算
      });
    </script>
    <meta name="description" content="系统性学习，打造完善的知识体系">
    
    <link rel="preload" href="/assets/css/0.styles.30ce95d4.css" as="style"><link rel="preload" href="/assets/js/app.a2d0ac2d.js" as="script"><link rel="preload" href="/assets/js/2.6d2266aa.js" as="script"><link rel="preload" href="/assets/js/94.517396bc.js" as="script"><link rel="prefetch" href="/assets/js/10.a56f3f8d.js"><link rel="prefetch" href="/assets/js/100.13a2d5e4.js"><link rel="prefetch" href="/assets/js/101.766996fe.js"><link rel="prefetch" href="/assets/js/102.263781e6.js"><link rel="prefetch" href="/assets/js/103.192765b9.js"><link rel="prefetch" href="/assets/js/104.8280cd3d.js"><link rel="prefetch" href="/assets/js/105.3ad0084c.js"><link rel="prefetch" href="/assets/js/106.0344c291.js"><link rel="prefetch" href="/assets/js/107.80e4eaf9.js"><link rel="prefetch" href="/assets/js/108.95402323.js"><link rel="prefetch" href="/assets/js/109.e42d7c45.js"><link rel="prefetch" href="/assets/js/11.c0cc9e98.js"><link rel="prefetch" href="/assets/js/110.fe64548d.js"><link rel="prefetch" href="/assets/js/111.78281284.js"><link rel="prefetch" href="/assets/js/112.eccae065.js"><link rel="prefetch" href="/assets/js/113.458fbd21.js"><link rel="prefetch" href="/assets/js/114.3157d04b.js"><link rel="prefetch" href="/assets/js/115.9a08b5bf.js"><link rel="prefetch" href="/assets/js/116.98c14a80.js"><link rel="prefetch" href="/assets/js/117.c99eb6ef.js"><link rel="prefetch" href="/assets/js/118.9415eb32.js"><link rel="prefetch" href="/assets/js/119.8677a924.js"><link rel="prefetch" href="/assets/js/12.ada7d686.js"><link rel="prefetch" href="/assets/js/120.90c94c3f.js"><link rel="prefetch" href="/assets/js/121.289ff03f.js"><link rel="prefetch" href="/assets/js/122.163e6cf3.js"><link rel="prefetch" href="/assets/js/123.6cf64cab.js"><link rel="prefetch" href="/assets/js/124.4fbd6264.js"><link rel="prefetch" href="/assets/js/125.8f408d49.js"><link rel="prefetch" href="/assets/js/126.fecd9dfa.js"><link rel="prefetch" href="/assets/js/127.fff3baac.js"><link rel="prefetch" href="/assets/js/128.9006ec12.js"><link rel="prefetch" href="/assets/js/129.bd73fd0d.js"><link rel="prefetch" href="/assets/js/13.7d5054e0.js"><link rel="prefetch" href="/assets/js/130.82ec8ca8.js"><link rel="prefetch" href="/assets/js/131.25af9bac.js"><link rel="prefetch" href="/assets/js/132.8517ca6b.js"><link rel="prefetch" href="/assets/js/133.f835df32.js"><link rel="prefetch" href="/assets/js/134.65e4285e.js"><link rel="prefetch" href="/assets/js/135.d5ae9ddf.js"><link rel="prefetch" href="/assets/js/136.b4809f7f.js"><link rel="prefetch" href="/assets/js/137.4a9d350b.js"><link rel="prefetch" href="/assets/js/138.0817585f.js"><link rel="prefetch" href="/assets/js/139.25212b17.js"><link rel="prefetch" href="/assets/js/14.dfdc52dc.js"><link rel="prefetch" href="/assets/js/140.f61db2a2.js"><link rel="prefetch" href="/assets/js/141.4d216e94.js"><link rel="prefetch" href="/assets/js/142.51c5e63e.js"><link rel="prefetch" href="/assets/js/143.5728dc3f.js"><link rel="prefetch" href="/assets/js/144.f287e90f.js"><link rel="prefetch" href="/assets/js/145.1cf839cb.js"><link rel="prefetch" href="/assets/js/146.23f4f258.js"><link rel="prefetch" href="/assets/js/147.d39c4f95.js"><link rel="prefetch" href="/assets/js/148.b1a175dc.js"><link rel="prefetch" href="/assets/js/149.a52de27b.js"><link rel="prefetch" href="/assets/js/15.4f0aba52.js"><link rel="prefetch" href="/assets/js/150.10168789.js"><link rel="prefetch" href="/assets/js/151.712cd6a8.js"><link rel="prefetch" href="/assets/js/152.3fe32db9.js"><link rel="prefetch" href="/assets/js/153.58f830dd.js"><link rel="prefetch" href="/assets/js/154.f5506c0b.js"><link rel="prefetch" href="/assets/js/155.715a7171.js"><link rel="prefetch" href="/assets/js/156.c373b316.js"><link rel="prefetch" href="/assets/js/157.7ae757e4.js"><link rel="prefetch" href="/assets/js/158.8547baa5.js"><link rel="prefetch" href="/assets/js/159.9236e9b2.js"><link rel="prefetch" href="/assets/js/16.401bab98.js"><link rel="prefetch" href="/assets/js/160.38f02fa7.js"><link rel="prefetch" href="/assets/js/161.33cfc804.js"><link rel="prefetch" href="/assets/js/162.b936f336.js"><link rel="prefetch" href="/assets/js/163.457054d9.js"><link rel="prefetch" href="/assets/js/164.d8f480fd.js"><link rel="prefetch" href="/assets/js/165.8d33e67c.js"><link rel="prefetch" href="/assets/js/166.24fd6fff.js"><link rel="prefetch" href="/assets/js/167.a71cfd81.js"><link rel="prefetch" href="/assets/js/168.f195e962.js"><link rel="prefetch" href="/assets/js/169.a233777b.js"><link rel="prefetch" href="/assets/js/17.ff1a5c44.js"><link rel="prefetch" href="/assets/js/170.e9f4408c.js"><link rel="prefetch" href="/assets/js/171.59c967e2.js"><link rel="prefetch" href="/assets/js/172.822a3819.js"><link rel="prefetch" href="/assets/js/173.c37db229.js"><link rel="prefetch" href="/assets/js/174.333678df.js"><link rel="prefetch" href="/assets/js/175.7c0f4462.js"><link rel="prefetch" href="/assets/js/176.29ec561f.js"><link rel="prefetch" href="/assets/js/177.66c9abc0.js"><link rel="prefetch" href="/assets/js/178.7ac94227.js"><link rel="prefetch" href="/assets/js/179.84edddc4.js"><link rel="prefetch" href="/assets/js/18.48189038.js"><link rel="prefetch" href="/assets/js/180.f9200d00.js"><link rel="prefetch" href="/assets/js/181.3dbd3f3d.js"><link rel="prefetch" href="/assets/js/182.92327331.js"><link rel="prefetch" href="/assets/js/183.6f4a7fa6.js"><link rel="prefetch" href="/assets/js/184.23cc8f2b.js"><link rel="prefetch" href="/assets/js/185.13f68d36.js"><link rel="prefetch" href="/assets/js/186.fee33fbb.js"><link rel="prefetch" href="/assets/js/187.45622918.js"><link rel="prefetch" href="/assets/js/188.d660fe0b.js"><link rel="prefetch" href="/assets/js/189.d66284c8.js"><link rel="prefetch" href="/assets/js/19.fe215aac.js"><link rel="prefetch" href="/assets/js/190.47c4010f.js"><link rel="prefetch" href="/assets/js/191.43e428b5.js"><link rel="prefetch" href="/assets/js/192.204764f1.js"><link rel="prefetch" href="/assets/js/193.5ba3e1f7.js"><link rel="prefetch" href="/assets/js/194.994dc46d.js"><link rel="prefetch" href="/assets/js/195.089189c2.js"><link rel="prefetch" href="/assets/js/196.dcb90b2f.js"><link rel="prefetch" href="/assets/js/197.f08d0d50.js"><link rel="prefetch" href="/assets/js/198.556c32f1.js"><link rel="prefetch" href="/assets/js/199.31bd0633.js"><link rel="prefetch" href="/assets/js/20.d701da2a.js"><link rel="prefetch" href="/assets/js/200.723aec7c.js"><link rel="prefetch" href="/assets/js/201.66d2af64.js"><link rel="prefetch" href="/assets/js/202.8edb3a46.js"><link rel="prefetch" href="/assets/js/203.ff89198b.js"><link rel="prefetch" href="/assets/js/204.193ae8af.js"><link rel="prefetch" href="/assets/js/205.c829f1c5.js"><link rel="prefetch" href="/assets/js/206.37bea224.js"><link rel="prefetch" href="/assets/js/207.db95cc40.js"><link rel="prefetch" href="/assets/js/208.97270da0.js"><link rel="prefetch" href="/assets/js/209.c0683036.js"><link rel="prefetch" href="/assets/js/21.1080a5de.js"><link rel="prefetch" href="/assets/js/210.93d642a2.js"><link rel="prefetch" href="/assets/js/211.5901dc1b.js"><link rel="prefetch" href="/assets/js/212.4f664375.js"><link rel="prefetch" href="/assets/js/213.fa04deb5.js"><link rel="prefetch" href="/assets/js/214.7b142a2c.js"><link rel="prefetch" href="/assets/js/215.7803263b.js"><link rel="prefetch" href="/assets/js/216.64db2edb.js"><link rel="prefetch" href="/assets/js/217.b41dbc99.js"><link rel="prefetch" href="/assets/js/218.e9327b94.js"><link rel="prefetch" href="/assets/js/219.63d9aab5.js"><link rel="prefetch" href="/assets/js/22.76e06f13.js"><link rel="prefetch" href="/assets/js/220.003286bb.js"><link rel="prefetch" href="/assets/js/221.b8b15996.js"><link rel="prefetch" href="/assets/js/222.0a20e90e.js"><link rel="prefetch" href="/assets/js/223.a19bafae.js"><link rel="prefetch" href="/assets/js/224.e9bcab46.js"><link rel="prefetch" href="/assets/js/225.5a36176a.js"><link rel="prefetch" href="/assets/js/226.be890eda.js"><link rel="prefetch" href="/assets/js/227.0e73737e.js"><link rel="prefetch" href="/assets/js/228.44593996.js"><link rel="prefetch" href="/assets/js/229.01729fa1.js"><link rel="prefetch" href="/assets/js/23.7076ecb8.js"><link rel="prefetch" href="/assets/js/24.d236b1c8.js"><link rel="prefetch" href="/assets/js/25.085e91d6.js"><link rel="prefetch" href="/assets/js/26.8c2f26f2.js"><link rel="prefetch" href="/assets/js/27.a1e3cc80.js"><link rel="prefetch" href="/assets/js/28.6c00042a.js"><link rel="prefetch" href="/assets/js/29.cfd8d697.js"><link rel="prefetch" href="/assets/js/3.b6a2a037.js"><link rel="prefetch" href="/assets/js/30.3d728bce.js"><link rel="prefetch" href="/assets/js/31.526dedbf.js"><link rel="prefetch" href="/assets/js/32.6b3ecd17.js"><link rel="prefetch" href="/assets/js/33.cabdeeb0.js"><link rel="prefetch" href="/assets/js/34.fa91d53d.js"><link rel="prefetch" href="/assets/js/35.c66844f8.js"><link rel="prefetch" href="/assets/js/36.3fa680ce.js"><link rel="prefetch" href="/assets/js/37.a92ad777.js"><link rel="prefetch" href="/assets/js/38.e7cc8ec1.js"><link rel="prefetch" href="/assets/js/39.2796c271.js"><link rel="prefetch" href="/assets/js/4.e81d099d.js"><link rel="prefetch" href="/assets/js/40.daf5b79e.js"><link rel="prefetch" href="/assets/js/41.eef20117.js"><link rel="prefetch" href="/assets/js/42.e8f1e994.js"><link rel="prefetch" href="/assets/js/43.f61d31c8.js"><link rel="prefetch" href="/assets/js/44.8dbd447e.js"><link rel="prefetch" href="/assets/js/45.66449725.js"><link rel="prefetch" href="/assets/js/46.4af09bf8.js"><link rel="prefetch" href="/assets/js/47.1289bfb2.js"><link rel="prefetch" href="/assets/js/48.a4fb9dbd.js"><link rel="prefetch" href="/assets/js/49.8751b36a.js"><link rel="prefetch" href="/assets/js/5.c08ba69c.js"><link rel="prefetch" href="/assets/js/50.75e594dd.js"><link rel="prefetch" href="/assets/js/51.3d254128.js"><link rel="prefetch" href="/assets/js/52.9c1413b9.js"><link rel="prefetch" href="/assets/js/53.5a3597d7.js"><link rel="prefetch" href="/assets/js/54.0d47034c.js"><link rel="prefetch" href="/assets/js/55.6d652079.js"><link rel="prefetch" href="/assets/js/56.ecc52ae0.js"><link rel="prefetch" href="/assets/js/57.ecfbc927.js"><link rel="prefetch" href="/assets/js/58.7cd62408.js"><link rel="prefetch" href="/assets/js/59.204705c1.js"><link rel="prefetch" href="/assets/js/6.6c5dca8e.js"><link rel="prefetch" href="/assets/js/60.b40b1d39.js"><link rel="prefetch" href="/assets/js/61.0b04acf8.js"><link rel="prefetch" href="/assets/js/62.7fbeb25d.js"><link rel="prefetch" href="/assets/js/63.b709d9fc.js"><link rel="prefetch" href="/assets/js/64.e183bd0e.js"><link rel="prefetch" href="/assets/js/65.c89124e0.js"><link rel="prefetch" href="/assets/js/66.caa96c79.js"><link rel="prefetch" href="/assets/js/67.11d21c7a.js"><link rel="prefetch" href="/assets/js/68.be82890e.js"><link rel="prefetch" href="/assets/js/69.14649e16.js"><link rel="prefetch" href="/assets/js/7.9d17a6f4.js"><link rel="prefetch" href="/assets/js/70.a7391131.js"><link rel="prefetch" href="/assets/js/71.437f0d23.js"><link rel="prefetch" href="/assets/js/72.5d8001be.js"><link rel="prefetch" href="/assets/js/73.a4a5d2ac.js"><link rel="prefetch" href="/assets/js/74.cd496622.js"><link rel="prefetch" href="/assets/js/75.773ff345.js"><link rel="prefetch" href="/assets/js/76.176d2fa0.js"><link rel="prefetch" href="/assets/js/77.c38d66f9.js"><link rel="prefetch" href="/assets/js/78.8ca89620.js"><link rel="prefetch" href="/assets/js/79.21f0b5ad.js"><link rel="prefetch" href="/assets/js/8.61c359d6.js"><link rel="prefetch" href="/assets/js/80.e75ea7ff.js"><link rel="prefetch" href="/assets/js/81.48187974.js"><link rel="prefetch" href="/assets/js/82.0f048d77.js"><link rel="prefetch" href="/assets/js/83.d2b53680.js"><link rel="prefetch" href="/assets/js/84.0aba3b37.js"><link rel="prefetch" href="/assets/js/85.7d57722c.js"><link rel="prefetch" href="/assets/js/86.b07deb45.js"><link rel="prefetch" href="/assets/js/87.3ea155a5.js"><link rel="prefetch" href="/assets/js/88.0369b082.js"><link rel="prefetch" href="/assets/js/89.8d286a9e.js"><link rel="prefetch" href="/assets/js/9.b44b1047.js"><link rel="prefetch" href="/assets/js/90.6cb0b442.js"><link rel="prefetch" href="/assets/js/91.3bd0ca3f.js"><link rel="prefetch" href="/assets/js/92.e244701b.js"><link rel="prefetch" href="/assets/js/93.ec9d3001.js"><link rel="prefetch" href="/assets/js/95.570e2963.js"><link rel="prefetch" href="/assets/js/96.d4608a89.js"><link rel="prefetch" href="/assets/js/97.4814fa03.js"><link rel="prefetch" href="/assets/js/98.b57acf57.js"><link rel="prefetch" href="/assets/js/99.662fa199.js">
    <link rel="stylesheet" href="/assets/css/0.styles.30ce95d4.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="前端AK君" class="logo"> <span class="site-name can-hide">前端AK君</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/kongyajie" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://github.com/kongyajie" target="_blank" rel="noopener noreferrer" class="nav-link external">
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>JS进阶</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端基础</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>前端框架</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/article/前端框架/vue/Vue系列之1-概览.html" class="sidebar-link">Vue系列之1-概览</a></li><li><a href="/article/前端框架/vue/Vue系列之2-使用.html" class="sidebar-link">Vue系列之2-使用</a></li><li><a href="/article/前端框架/vue/Vue系列之3-周边工具.html" class="sidebar-link">Vue系列之3-周边工具</a></li><li><a href="/article/前端框架/vue/Vue系列之4-原理.html" class="active sidebar-link">Vue系列之4-原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#前言" class="sidebar-link">前言</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#一、vue是什么" class="sidebar-link">一、Vue是什么？</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#_1、如何理解mvvm" class="sidebar-link">1、如何理解MVVM</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#_2、mvvm在vue中的体现" class="sidebar-link">2、MVVM在Vue中的体现</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#_3、vue三要素" class="sidebar-link">3、Vue三要素</a></li></ul></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#二、vue三要素-响应式" class="sidebar-link">二、Vue三要素-响应式</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#object-defineproperty-ie9" class="sidebar-link">Object.defineProperty（IE9+）</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#proxy-vue3-0-ie11" class="sidebar-link">proxy（Vue3.0，IE11+）</a></li></ul></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#三、vue三要素-渲染-虚拟dom-virtual-dom" class="sidebar-link">三、Vue三要素-渲染：虚拟DOM（Virtual DOM）</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#四、diff算法-vdom核心部分" class="sidebar-link">四、diff算法-vdom核心部分</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#概述" class="sidebar-link">概述：</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#树diff的时间复杂度o-n-3" class="sidebar-link">树diff的时间复杂度O(n^3)</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#优化时间复杂度到o-n" class="sidebar-link">优化时间复杂度到O(n)</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#diff算法流程" class="sidebar-link">diff算法流程</a></li></ul></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#五、vue三要素-模板编译" class="sidebar-link">五、Vue三要素-模板编译</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#六、vue的组件渲染-更新过程" class="sidebar-link">六、Vue的组件渲染/更新过程</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#七、vue3-0的性能优化" class="sidebar-link">七、Vue3.0的性能优化</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#回顾" class="sidebar-link">回顾</a></li><li class="sidebar-sub-header"><a href="/article/前端框架/vue/Vue系列之4-原理.html#参考" class="sidebar-link">参考</a></li></ul></li><li><a href="/article/前端框架/vue/Vue系列之5-常见问题.html" class="sidebar-link">Vue系列之5-常见问题</a></li><li><a href="/article/前端框架/vue/Vue系列之6-Vue3.html" class="sidebar-link">Vue系列之6-Vue3</a></li><li><a href="/article/前端框架/react/React系列之1-概览.html" class="sidebar-link">React系列之1-概览</a></li><li><a href="/article/前端框架/react/React系列之2-使用.html" class="sidebar-link">React系列之2-使用</a></li><li><a href="/article/前端框架/react/React系列之3-周边工具.html" class="sidebar-link">React系列之3-周边工具</a></li><li><a href="/article/前端框架/react/React系列之4-原理.html" class="sidebar-link">React系列之4-原理</a></li><li><a href="/article/前端框架/react/React系列之5-常见问题.html" class="sidebar-link">React系列之5-常见问题</a></li><li><a href="/article/前端框架/react/React系列之6-hooks.html" class="sidebar-link">React系列之6-hooks</a></li><li><a href="/article/前端框架/webpack/webpack.html" class="sidebar-link">Webpack 笔记</a></li><li><a href="/article/前端框架/webpack/webpack分享.html" class="sidebar-link">Webpack分享</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据结构与算法</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>设计模式</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>前端自检</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="vue系列之4-原理"><a href="#vue系列之4-原理" class="header-anchor">#</a> Vue系列之4-原理</h1> <h2 id="前言"><a href="#前言" class="header-anchor">#</a> 前言</h2> <ul><li>前端三大框架对比</li></ul> <table><thead><tr><th>框架</th> <th>发布年份</th> <th>出自</th> <th>star数</th> <th>特性</th></tr></thead> <tbody><tr><td>Angular</td> <td>2010年</td> <td>Google</td> <td>73.7k</td> <td>双向数据绑定</td></tr> <tr><td>React</td> <td>2013年</td> <td>Facebook</td> <td>169k</td> <td>VirtualDOM、Redux</td></tr> <tr><td>Vue</td> <td>2014年</td> <td>尤雨溪EvanYou</td> <td>184k</td> <td>更轻量、易于上手、中文文档友好</td></tr></tbody></table> <ul><li><p>框架趋同/互相借鉴</p> <ul><li>Vue借鉴knockout模板引擎、借鉴Angular双向数据绑定、借鉴React虚拟dom/redux/JSX</li> <li>跨端开发（Ionic/ReactNative/Weex）</li> <li>桌面开发（electron支持vue/react）</li> <li>总之，你有我有全都有，大家好才是真的好</li></ul></li> <li><p>类vue的开发模式（新赛道）：小程序、uniapp</p></li></ul> <p>阅读本文后你将了解到：</p> <ul><li>Vue是什么？解决了什么问题？</li> <li>MVVM架构</li> <li>三要素（响应式、模板编译、vdom/diff算法）</li> <li>组件渲染/更新过程</li></ul> <p>PS：本文内容主要针对Vue2，涉及少量vue3.0内容</p> <h2 id="一、vue是什么"><a href="#一、vue是什么" class="header-anchor">#</a> 一、Vue是什么？</h2> <p><strong>vue是什么？</strong></p> <blockquote><p>Vue (读音 /vjuː/，类似于 <strong>view</strong>) 是一套用于<strong>构建用户界面的渐进式框架</strong>。与其它大型框架不同的是，Vue 被设计为可以自底向上逐层应用。Vue 的核心库只关注视图层，不仅易于上手，还便于与第三方库或既有项目整合。另一方面，当与<strong>现代化的工具链以及各种支持类库</strong>结合使用时，Vue 也完全能够为复杂的单页应用提供驱动。</p></blockquote> <ul><li>轻量级渐进式框架（便于与第三方库或既有项目整合）</li> <li>生态丰富（vue-cli、vue-router、vuex、社区UI组件库...）</li> <li>易于上手（入门简单、中文文档友好）</li></ul> <p><strong>vue解决了什么问题？</strong></p> <ul><li><strong>HTML</strong>：从0到1</li> <li><strong>CSS</strong>：提供装饰</li> <li><strong>JavaScript(DOM)</strong>：支持页面动态化（例如倒计时）</li> <li><strong>jQuery</strong>：解决浏览器兼容问题、优雅API（解放前端，造轮子）</li> <li><strong>Vue</strong>：<strong>数据驱动视图</strong>，让开发者从DOM操作中解放（如倒计时，自加器）</li></ul> <p><strong>疑问：数据驱动视图是怎么做到的？（数据变化 -&gt; 视图更新）</strong></p> <h3 id="_1、如何理解mvvm"><a href="#_1、如何理解mvvm" class="header-anchor">#</a> 1、如何理解MVVM</h3> <blockquote><p>MVVM是一种软件架构模式，MVVM是MVP的变体，MVP模式和MVVM模式都是MVC模式的变体。<a href="http://www.ruanyifeng.com/blog/2015/02/mvcmvp_mvvm.html" target="_blank" rel="noopener noreferrer">MVC，MVP 和 MVVM 的图示<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></blockquote> <blockquote><p>软件构架对代码进行解耦分层，各层互不影响，有效降低了开发复杂度。我们可以通过调整MVC三者之前的通信模式，来达到一定的架构目的。</p></blockquote> <p>MVVM对视图更新模式的影响</p> <ul><li>静态渲染：更新需要进行DOM操作，如ASP/JSP/PHP，适合业务简单的场景</li> <li>数据驱动视图：通过数据即可更新视图，如Vue/React/Angular，适合业务复杂的场景</li></ul> <p>MVVM包含3部分：</p> <ul><li><strong>View</strong>：用户看到屏幕的结构、布局和外观，也称UI</li> <li><strong>ViewModel</strong>：是一个绑定器，能和 <code>View</code> 和 <code>Model</code> 层进行通信</li> <li><strong>Model</strong>：是数据和逻辑</li></ul> <h3 id="_2、mvvm在vue中的体现"><a href="#_2、mvvm在vue中的体现" class="header-anchor">#</a> 2、MVVM在Vue中的体现</h3> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/a3e0fecfffa34c1f9e8d34572f52e7e2~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p>示例：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>app<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>{{ message }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>reverse<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>reverse<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">var</span> app <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">el</span><span class="token operator">:</span> <span class="token string">&quot;#app&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">data</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">message</span><span class="token operator">:</span> <span class="token string">&quot;Hello Vue123!!&quot;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>message <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">reverse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>View: template模板</li> <li>Model: data数据</li> <li>ViewModel: Vue实例</li></ul> <p>PS：Vue没有严格遵循 MVVM 模式：严格的MVVM要求View不能和Model直接通信，而Vue在组件中提供了$refs这个属性，让Model可以直接操作View，违反了这一规定。</p> <p><strong>疑问：vue是如何实现MVVM的？</strong></p> <h3 id="_3、vue三要素"><a href="#_3、vue三要素" class="header-anchor">#</a> 3、Vue三要素</h3> <ul><li>响应式：vue如何监听到 data 的每个属性变化？</li> <li>模板引擎：vue的模板如何被解析？</li> <li>渲染：vue如何进行高效渲染？</li></ul> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/fa6b219179c14b13abd1d436703e2099~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <h2 id="二、vue三要素-响应式"><a href="#二、vue三要素-响应式" class="header-anchor">#</a> 二、Vue三要素-响应式</h2> <blockquote><p>响应式：组件 data 的数据一旦变化，立刻触发视图的更新。
响应式如何实现？</p></blockquote> <h3 id="object-defineproperty-ie9"><a href="#object-defineproperty-ie9" class="header-anchor">#</a> Object.defineProperty（IE9+）</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">let</span> value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'trigger get'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 收集依赖 todo...</span>
        <span class="token keyword">return</span> value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">val</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'trigger set'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>val <span class="token operator">!==</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            value <span class="token operator">=</span> val<span class="token punctuation">;</span>
            <span class="token comment">// 数据变更，需要重新渲染 todo...</span>
        <span class="token punctuation">}</span>
        
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token punctuation">;</span>
obj<span class="token punctuation">.</span>a <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>缺点</p> <ul><li>深度监听需要递归到底，一次性计算量大</li> <li>无法监听新增属性/删除属性（Vue.$set）</li> <li>无法原生监听数组，需要特殊处理</li></ul> <h3 id="proxy-vue3-0-ie11"><a href="#proxy-vue3-0-ie11" class="header-anchor">#</a> proxy（Vue3.0，IE11+）</h3> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> reactiveObj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Proxy</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'trigger get'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// 收集依赖 todo...</span>
        <span class="token keyword">return</span> obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">set</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> prop<span class="token punctuation">,</span> value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'trigger set'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">=</span> value<span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">[</span>prop<span class="token punctuation">]</span> <span class="token operator">!==</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 数据变更，需要重新渲染 todo...</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><p>缺点：</p> <ul><li>有兼容性的问题，caniuse 95%</li> <li>它会修改JavaScript的一些底层代码的执行方式，所以它是无法被完全polyfill的</li></ul> <p>响应式带来的问题：</p> <ul><li>jQuery可以自行控制DOM操作的时机，手动调整，而响应式的DOM操作则在内部进行；</li> <li>DOM 操作非常耗费性能</li></ul> <p><strong>疑问：如何有效控制DOM操作？</strong></p> <h2 id="三、vue三要素-渲染-虚拟dom-virtual-dom"><a href="#三、vue三要素-渲染-虚拟dom-virtual-dom" class="header-anchor">#</a> 三、Vue三要素-渲染：虚拟DOM（Virtual DOM）</h2> <blockquote><p>Vue是数据驱动视图，如何有效控制DOM操作？</p></blockquote> <ul><li>解决方案：<code>vdom</code> <ul><li>JS执行速度快</li> <li>用JS模拟DOM结构，计算出最小的变更，操作DOM</li></ul></li> <li><code>vdom</code> 是优化方案，不是响应式必须
<ul><li><code>vdom</code> 是实现 <code>vue</code> 和 <code>react</code> 的重要基石</li> <li><code>diff算法</code> 是 <code>vdom</code> 中最核心、最关键的部分</li></ul></li> <li>用JS模拟DOM结构：<code>vnode</code></li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>div1<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>vdom<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token property">font-size</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span><span class="token punctuation">&gt;</span></span>a<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">'div'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">classname</span><span class="token operator">:</span> <span class="token string">'container'</span><span class="token punctuation">,</span>
        <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">'div1'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">'p'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token string">'vdom'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token punctuation">{</span>
            <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">'ul'</span><span class="token punctuation">,</span>
            <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">'font-size: 20px;'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token punctuation">[</span>
                <span class="token punctuation">{</span>
                    <span class="token literal-property property">tag</span><span class="token operator">:</span> <span class="token string">'li'</span><span class="token punctuation">,</span>
                    <span class="token literal-property property">children</span><span class="token operator">:</span> <span class="token string">'a'</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">]</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ul><li><code>vdom</code> 小结：数据驱动视图的模式下，有效控制DOM操作
<ul><li><code>vnode</code>：用JS模拟DOM结构</li> <li><code>diff算法</code>：新旧vnode对比，得出最小更新范围，最后更新DOM</li></ul></li></ul> <h2 id="四、diff算法-vdom核心部分"><a href="#四、diff算法-vdom核心部分" class="header-anchor">#</a> 四、diff算法-vdom核心部分</h2> <blockquote><p>diff 算法是一种通过同层的树节点进行比较的高效算法，避免了对树进行逐层搜索遍历，所以时间复杂度只有 O(n)</p></blockquote> <h3 id="概述"><a href="#概述" class="header-anchor">#</a> 概述：</h3> <ul><li>diff即对比，是一个广泛的概念（非独创），如linux diff命令，git diff等</li> <li>两个js对象也可以做diff</li> <li>两棵树做diff，如这里的vdom diff</li></ul> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/286a4362483c4cafb3fb8615cefe94bc~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <h3 id="树diff的时间复杂度o-n-3"><a href="#树diff的时间复杂度o-n-3" class="header-anchor">#</a> 树diff的时间复杂度O(n^3)</h3> <ul><li>1、遍历tree1</li> <li>2、遍历tree2</li> <li>3、排序</li> <li>1000个节点，要计算1亿次，算法不可用</li></ul> <h3 id="优化时间复杂度到o-n"><a href="#优化时间复杂度到o-n" class="header-anchor">#</a> 优化时间复杂度到O(n)</h3> <ul><li>只比较同一层级，不跨级比较</li> <li>tag不相同，则直接删掉重建，不再深度比较</li> <li>tag和key，两者都相同，则认为是相同节点，更新dom，并继续比较节点的子元素</li></ul> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/39a203ea582649f5aba9bf27f86aada7~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/68ef124893964d349a15fa4f32759b2d~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <h3 id="diff算法流程"><a href="#diff算法流程" class="header-anchor">#</a> diff算法流程</h3> <p>1、首次渲染，取vnode进行渲染即可</p> <p>2、数据更新后，将vnode和oldVnode进行对比</p> <ul><li>从根节点开始遍历，判断当前的旧节点和新节点是否同一节点（sel和key相同）</li> <li>若不是同一节点，则删掉重建；</li> <li>若是同一节点，则更新当前节点dom，继续处理子元素children</li></ul> <p>3、<strong>子元素children的对比算法</strong>（尽可能多地复用真实DOM,尽可能少的添加删除真实DOM）
思路：添加4个指针，分别指向新旧children的开始和结束比较的过程中，循环从两边向中间收拢；</p> <ul><li>第一步：分别进行开始开始、结束结束、开始结束、结束开始对比，若匹配成功，则指针向中间收拢；</li> <li>第二步：若第一步未匹配，则在旧children中遍历查找是否匹配新children的开始节点，若匹配成功，则移动旧节点到对应位置；</li> <li>第三步：循环结束后，根据新老节点的数目不同做相应的添加或者删除节点操作</li></ul> <p>各场景图示（这里看动画 👉  <a href="https://www.bilibili.com/video/BV1b5411V7i3?from=search&amp;seid=4125072074822008044" target="_blank" rel="noopener noreferrer">diff算法图解动画<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>）</p> <ul><li>k -&gt; key</li> <li>a/b/c/d -&gt; 元素内容</li> <li>所有元素的tag都相同，可以理解均为 <code>&lt;li&gt;</code></li></ul> <p><img src="https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/d0d8dca6afe24cd795af2edc2be7e049~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5295957102da4ba2b13eb6c8c65b4f73~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/9ee3dec92df84644982cfb237166e12c~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e62d8912026f4bbf9f1975de26b8de73~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p><img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/ad12f271b8484572b14e32048fbba20f~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p>删除节点
<img src="https://p9-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4f94f32ebd3040c9bec27350e554f8cf~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p>新增节点
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/5bdb95ad733f414f9542a5ebb4ec9175~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p>未设置key
<img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/027885ad98f7446d8eefa107c481c6a7~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p>设置key
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/50d9e7701ad14f779de617fb3368fc3c~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <p>需要说明的是，节点的更新有三种开销：</p> <ul><li>第一种是不能复用节点时，重建节点，更新dom</li> <li>第二种是能复用节点时，直接更新dom</li> <li>第三种是能复用节点，但需移动dom，然后更新</li></ul> <p>数组加key即符合第三种情况。</p> <h2 id="五、vue三要素-模板编译"><a href="#五、vue三要素-模板编译" class="header-anchor">#</a> 五、Vue三要素-模板编译</h2> <ul><li><p>概览</p> <ul><li>前置知识：JS的with语法
<ul><li>改变{}内自由变量的查找规则，当做obj属性来查找</li> <li>如果找不到匹配的obj属性，就会报错</li> <li>with要慎用，它打破了作用域规则，易读性变差</li></ul></li> <li>vue模板(不是html，有指令、插值、JS表达式)到底是什么？</li> <li>vue如何处理模板？组件渲染和更新过程？</li></ul></li> <li><p>步骤：</p> <ol><li><strong>vue-template-complier将模板<code>&lt;template&gt;</code>编译为 render 函数</strong></li> <li><strong>执行 render 函数生成 vnode</strong></li> <li>基于 vnode 再执行 patch 和 diff，进行渲染和更新</li> <li>修改数据后，会生成新的vnode</li></ol></li> <li><p>vue模板被编译成什么（ <code>vue-template-compiler</code> ）</p></li></ul> <p><code>&lt;p&gt;&lt;/p&gt;</code></p> <p><code>with(this){return _c('p', [_v(_s(message))])}</code></p> <p>类似于：</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">createElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">createElement</span><span class="token punctuation">(</span>
      <span class="token string">'p'</span><span class="token punctuation">,</span>   <span class="token comment">// 标签名称</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>message<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 子节点数组</span>
    <span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>其他注意点：
<ul><li>使用webpack vue-loader，会在开发环境编译模板</li> <li>vue组件可以用render代替template，react默认使用render写法</li></ul></li></ul> <h2 id="六、vue的组件渲染-更新过程"><a href="#六、vue的组件渲染-更新过程" class="header-anchor">#</a> 六、Vue的组件渲染/更新过程</h2> <ul><li>初次渲染过程
<ol><li>解析模板为render函数（或在开发环境已完成，vue-loader）</li> <li>（页面渲染时）执行render函数，生成vnode，patch(elem,vnode)</li> <li>触发响应式，监听data属性getter setter</li></ol></li> <li>更新过程
<ol><li>修改data，触发setter（此前在getter中已被监听）</li> <li>重新执行render函数，生成newVnode</li> <li>对比新旧vnode，patch(vnode,newVnode)，更新到dom上</li></ol></li></ul> <p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/981c630c3aa8411d888a6c2442a88baa~tplv-k3u1fbpfcp-watermark.image" alt="image.png"></p> <h2 id="七、vue3-0的性能优化"><a href="#七、vue3-0的性能优化" class="header-anchor">#</a> 七、Vue3.0的性能优化</h2> <blockquote><p>性能比vue2.x快1.2～2倍</p></blockquote> <ul><li><p><strong>静态标记</strong>：diff方法优化vue2.x中的虚拟dom是进行全量的对比。而vue3.0新增了静态标记。在与上次虚拟节点进行对比的时候，只对比带有patch flag的节点，并且可以通过flag的信息得知当前节点要对比的具体内容。</p></li> <li><p><strong>静态提升</strong>：vue2.x中无论元素是否参与更新，每次都会重新创建，然后再渲染。vue3.0中对于不参与更新的元素，会做静态提升，只会被创建一次，在渲染时直接复用即可。</p></li> <li><p><strong>事件侦听器缓存</strong>：默认情况下，如onClick事件会被视为动态绑定，所以每次都会追踪它的变化，但是因为是同一个函数，所以不用追踪变化，直接缓存起来复用即可。</p></li></ul> <h2 id="回顾"><a href="#回顾" class="header-anchor">#</a> 回顾</h2> <ul><li>Vue是什么？解决了什么问题？</li> <li>MVVM架构</li> <li>三要素：响应式、模板编译、vdom/diff算法（重要）</li> <li>组件渲染/更新过程（重要）</li> <li>异步渲染
<ul><li>$nextTick</li> <li>汇总data的修改，一次性更新视图</li> <li>减少DOM操作次数，提高性能</li></ul></li></ul> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://www.infoq.cn/article/udlcpkh4iqb0cr5wgy7f" target="_blank" rel="noopener noreferrer">vue的diff算法执行过程解析<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.bilibili.com/video/BV1b5411V7i3?from=search&amp;seid=4125072074822008044" target="_blank" rel="noopener noreferrer">diff算法图解动画<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://developer.51cto.com/art/202010/628347.htm" target="_blank" rel="noopener noreferrer">Vue3.0是如何变快的<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">3/2/2022, 7:48:24 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/article/前端框架/vue/Vue系列之3-周边工具.html" class="prev">
        Vue系列之3-周边工具
      </a></span> <span class="next"><a href="/article/前端框架/vue/Vue系列之5-常见问题.html">
        Vue系列之5-常见问题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><div></div></div></div>
    <script src="/assets/js/app.a2d0ac2d.js" defer></script><script src="/assets/js/2.6d2266aa.js" defer></script><script src="/assets/js/94.517396bc.js" defer></script>
  </body>
</html>
